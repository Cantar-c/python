{% extends "base.html" %}

{% block title %}BaiyunTube - 用户{% endblock %}

{% block head %}
<link rel="stylesheet" href="static/css/login.css">
<script src="static/js/video_user.js"></script>
{% endblock %}

{% block content %}
<div id="user_info" style="text-align: center; margin-top: 20px;"></div>

<div style="display: flex; justify-content: center; align-items: center;margin-top: 50px;">
    <img id="loading" class="video" src="/static/img/loading.gif" alt="loading" style="max-width: 100%; max-height: 100%;">
</div>

<section class="video_grid" id="videoGrid"></section>
{% endblock %}

{% block foot %}
<script>
    $(document).ready(function () {
        $.ajax({
            url: '/api/user_info',
            method: 'GET',
            dataType: 'json',
            success: function (res) {
                if (res && res.code === 200 && res.data) {
                    const user = res.data;

                    let adminLinks = '';
                    if (user.id === 0) {
                        adminLinks = `
                            <div style="margin-top: 20px;">
                                <a href="/users" style="margin-right: 20px; color: #3498db; text-decoration: none;">用户管理</a>
                                <a href="/videos" style="color: #3498db; text-decoration: none;">视频管理</a>
                            </div>
                        `;
                    }

                    const userHtml = `
                        <div class="user_info_card" style="text-align: center;">
                            <img src="${user.avatar}" alt="用户头像" style="width:100px;height:100px;border-radius:50%;margin-bottom:10px;">
                            <h2 id="user_name" style="color: #808080;">${user.username}</h2>
                            ${adminLinks}
                        </div>
                    `;
                    $('#user_info').html(userHtml);
                } else {
                    $('#user_info').html('<p style="color: #999;">无法获取用户信息</p>');
                }
            },
            error: function () {
                $('#user_info').html('<p style="color: red;">请求用户信息失败</p>');
            }
        });
    });
</script>
{% endblock %}
